<!DOCTYPE html>
<html lang="sq">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#8e24aa">
    <meta name="description" content="Faqja e kyçjes për prindërit në platformën e Shkollës Fillore 'Kenan Halimi'">
    <title>Kyçja e Prindërve | Shkolla Fillore "Kenan Halimi"</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <style>
        :root {
            --primary: #8e24aa;
            --primary-light: #ba68c8;
            --primary-dark: #4a148c;
            --secondary: #ff9800;
            --secondary-light: #ffb74d;
            --background: linear-gradient(135deg, #fff9c4 0%, #e1bee7 100%);
            --card-shadow: 0 10px 30px rgba(142, 36, 170, 0.12);
            --text-dark: #4a148c;
            --text-medium: #7b1fa2;
            --text-light: #9c27b0;
        }
        
        /* Background Elements */
        .background-shapes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        
        .shape {
            position: absolute;
            opacity: 0.05;
            border-radius: 50%;
        }
        
        .shape-1 {
            width: 500px;
            height: 500px;
            background: var(--primary);
            top: -250px;
            left: -100px;
        }
        
        .shape-2 {
            width: 400px;
            height: 400px;
            background: var(--primary-light);
            bottom: -200px;
            right: -100px;
        }
        
        .shape-3 {
            width: 250px;
            height: 250px;
            background: var(--secondary);
            top: 30%;
            right: 15%;
        }
        
        body {
            background: var(--background);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            font-family: 'Roboto', sans-serif;
            color: var(--text-dark);
            margin: 0;
            padding: 0;
        }
        
        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%);
            color: white;
            padding: 30px 0 20px;
            text-align: center;
            position: relative;
            box-shadow: 0 4px 20px rgba(142, 36, 170, 0.2);
        }
        
        header::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 0;
            right: 0;
            height: 40px;
            background: white;
            border-radius: 50% 50% 0 0 / 100% 100% 0 0;
            z-index: 1;
        }
        
        .logo-header-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            position: relative;
            z-index: 2;
        }
        
        .school-logo {
            width: 65px;
            height: 65px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(74, 20, 140, 0.2);
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .school-logo svg {
            width: 85%;
            height: 85%;
        }
        
        /* Custom color for the school logo for parent section */
        .school-logo svg rect {
            fill: var(--primary-light);
        }
        
        .school-logo svg rect:nth-of-type(2) {
            fill: var(--primary-dark);
        }
        
        .logo-header-title {
            font-family: 'Baloo 2', cursive;
            font-size: 2.4rem;
            font-weight: 700;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        header p {
            margin: 10px 0 0;
            font-size: 1.1rem;
            opacity: 0.9;
            position: relative;
            z-index: 2;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        /* Login Form Container */
        .login-container {
            width: 100%;
            max-width: 450px;
            margin: 40px auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            box-shadow: var(--card-shadow);
            padding: 35px;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s;
        }
        
        .login-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(to right, var(--primary-light), var(--primary), var(--primary-dark));
        }
        
        /* Form Header */
        .form-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .form-icon {
            font-size: 3.5rem;
            color: var(--primary);
            margin-bottom: 15px;
            animation: pulse 1.5s infinite alternate;
        }
        
        .form-title {
            font-family: 'Baloo 2', cursive;
            font-size: 2rem;
            color: var(--text-dark);
            margin: 0 0 10px;
        }
        
        .form-subtitle {
            color: var(--text-medium);
            font-size: 1rem;
            margin: 0 0 30px;
            line-height: 1.5;
        }
        
        /* Form Fields */
        .form-group {
            margin-bottom: 25px;
            position: relative;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-dark);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px 12px 45px;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-sizing: border-box;
            background-color: #f9fbfd;
            box-shadow: 0 2px 5px rgba(142, 36, 170, 0.05);
        }
        
        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(142, 36, 170, 0.15);
            background-color: #fff;
        }
        
        .form-icon-field {
            position: absolute;
            top: 40px;
            left: 15px;
            color: var(--primary);
            opacity: 0.7;
            transition: all 0.3s ease;
        }
        
        .form-control:focus + .form-icon-field {
            color: var(--primary-dark);
            opacity: 1;
        }
        
        /* Password Toggle */
        .password-toggle {
            position: absolute;
            top: 40px;
            right: 15px;
            color: #9e9e9e;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .password-toggle:hover {
            color: var(--primary);
        }
        
        /* Remember Me Checkbox */
        .form-check {
            display: flex;
            align-items: center;
        }
        
        .form-check-input {
            width: 18px;
            height: 18px;
            margin-right: 10px;
            accent-color: var(--primary);
            cursor: pointer;
        }
        
        .form-check-label {
            color: var(--text-medium);
            font-size: 0.95rem;
            cursor: pointer;
        }
        
        /* Login Button */
        .login-btn {
            display: block;
            width: 100%;
            padding: 14px;
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(142, 36, 170, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .login-btn:hover {
            background: linear-gradient(to right, var(--primary-dark), var(--primary));
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(142, 36, 170, 0.3);
        }
        
        .login-btn:active {
            transform: translateY(1px);
            box-shadow: 0 2px 8px rgba(142, 36, 170, 0.2);
        }
        
        /* Button ripple effect */
        .login-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }
        
        .login-btn:active::after {
            width: 300px;
            height: 300px;
            opacity: 0;
        }
        
        /* Form Footer */
        .form-footer {
            margin-top: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.95rem;
        }
        
        .form-footer a {
            color: var(--primary);
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .form-footer a:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }
        
        /* Divider */
        .divider {
            display: flex;
            align-items: center;
            margin: 25px 0;
            color: #9e9e9e;
        }
        
        .divider::before, 
        .divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: #e0e0e0;
        }
        
        .divider-text {
            padding: 0 15px;
            font-size: 0.9rem;
        }
        
        /* QR Code Option */
        .qr-login {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 15px;
        }
        
        .qr-title {
            font-size: 1rem;
            color: var(--text-medium);
            margin-bottom: 15px;
        }
        
        .qr-code {
            width: 150px;
            height: 150px;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 10px;
            background: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .qr-code img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .qr-help {
            font-size: 0.85rem;
            color: #757575;
            text-align: center;
            max-width: 250px;
        }
        
        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            from {
                transform: scale(1);
                opacity: 0.8;
            }
            to {
                transform: scale(1.05);
                opacity: 1;
            }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .login-container {
                margin: 30px 15px;
                padding: 25px 20px;
            }
            
            .logo-header-title {
                font-size: 2rem;
            }
            
            .school-logo {
                width: 55px;
                height: 55px;
            }
        }
        
        @media (max-width: 480px) {
            header {
                padding: 25px 0 15px;
            }
            
            .logo-header-title {
                font-size: 1.8rem;
            }
            
            .school-logo {
                width: 45px;
                height: 45px;
            }
            
            .form-title {
                font-size: 1.7rem;
            }
            
            .form-footer {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
        }
    </style>
    
    <!-- Shtojmë CSS për elementët e sigurisë -->
    <style>
        /* Stili për mesazhet e sigurisë */
        .security-alert {
            display: none;
            padding: 12px;
            background-color: rgba(244, 67, 54, 0.1);
            border-left: 4px solid #f44336;
            margin-bottom: 20px;
            color: #d32f2f;
            font-size: 0.95rem;
            border-radius: 4px;
        }
        
        .security-info {
            margin-top: 10px;
            font-size: 0.8rem;
            color: #757575;
            padding: 8px 12px;
            background-color: rgba(142, 36, 170, 0.05);
            border-radius: 4px;
        }
        
        .password-strength-meter {
            height: 5px;
            background-color: #e0e0e0;
            margin-top: 8px;
            border-radius: 3px;
            position: relative;
            overflow: hidden;
        }
        
        .password-strength-value {
            height: 100%;
            width: 0;
            background-color: #f44336;
            transition: width 0.3s ease, background-color 0.3s ease;
        }
        
        .captcha-container {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: #f5f9ff;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            text-align: center;
        }
        
        .captcha-image {
            background-color: #fff;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 10px;
            display: inline-block;
            -webkit-user-select: none;
            user-select: none;
        }
        
        .attempts-warning {
            display: none;
            margin-top: 10px;
            padding: 8px 12px;
            background-color: #fff8e1;
            border-left: 4px solid #ffb300;
            color: #ff8f00;
            font-size: 0.9rem;
            border-radius: 4px;
        }
        
        .privacy-notice {
            font-size: 0.8rem;
            color: var(--text-medium);
            margin-top: 20px;
            text-align: center;
        }
        
        .privacy-icon {
            font-size: 0.9rem;
            margin-right: 3px;
            color: var(--primary);
        }
        
        .security-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 12px;
            gap: 5px;
            font-size: 0.85rem;
            color: #558b2f;
        }
        
        .session-expire-warning {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: rgba(33, 33, 33, 0.9);
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            display: none;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .session-expire-timer {
            font-weight: 700;
            color: #ff9800;
        }
        
        .session-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .session-button {
            padding: 6px 12px;
            border-radius: 4px;
            border: none;
            font-size: 0.85rem;
            cursor: pointer;
            font-weight: 600;
        }
        
        .extend-session {
            background-color: var(--primary-light);
            color: white;
        }
        
        .logout-session {
            background-color: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
        }

        /* Loading Indicator */
        .loading-indicator {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.8);
            z-index: 10;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            border-radius: 12px;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(142, 36, 170, 0.3);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }
        
        .loading-text {
            color: var(--primary);
            font-weight: 500;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Background Decorative Elements -->
    <div class="background-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
    </div>
    
    <!-- Header with Logo -->
    <header>
        <div class="logo-header-container">
            <div class="school-logo">
                <svg viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="30" cy="30" r="28" fill="#fff" stroke="#ba68c8" stroke-width="3"/>
                    <rect x="18" y="28" width="24" height="12" rx="4" fill="#ba68c8"/>
                    <rect x="24" y="18" width="12" height="14" rx="3" fill="#4a148c"/>
                    <circle cx="30" cy="25" r="3" fill="#fff9c4"/>
                </svg>
            </div>
            <h1 class="logo-header-title">Shkolla Fillore "Kenan Halimi"</h1>
        </div>
        <p>Platforma digjitale për prindërit</p>
    </header>
    
    <!-- Main Content -->
    <main>
        <div class="login-container">
            <div class="form-header">
                <div class="form-icon">
                    <i class="fas fa-users"></i>
                </div>
                <h2 class="form-title">Kyçja për Prindër</h2>
                <p class="form-subtitle">Mirë se vini në platformën digjitale për prindër. Ju lutemi kyçuni për të qasur informacionet e fëmijës suaj.</p>
            </div>
            
            <form id="login-form" action="dashboard_prinder.html" method="POST">
                <!-- Shtojmë elementin për mesazhet e sigurisë -->
                <div class="security-alert" id="securityAlert"></div>
                
                <div class="attempts-warning" id="attemptsWarning"></div>
                
                <div class="form-group">
                    <label for="email" class="form-label">Email ose Emri i Përdoruesit</label>
                    <input type="text" id="email" name="email" class="form-control" required>
                    <i class="fas fa-user form-icon-field"></i>
                </div>
                
                <div class="form-group">
                    <label for="password" class="form-label">Fjalëkalimi</label>
                    <input type="password" id="password" name="password" class="form-control" required>
                    <i class="fas fa-lock form-icon-field"></i>
                    <button type="button" class="password-toggle" id="password-toggle" aria-label="Shfaq/fshih fjalëkalimin">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                
                <div class="form-group">
                    <div class="form-check">
                        <input type="checkbox" id="remember" name="remember" class="form-check-input">
                        <label for="remember" class="form-check-label">Më mbaj mend</label>
                    </div>
                </div>
                
                <!-- CAPTCHA Container -->
                <div class="captcha-container" id="captchaContainer">
                    <div class="captcha-image" id="captchaImage">
                        <span style="font-family: 'Courier New', monospace; font-weight: bold; font-size: 1.2rem; letter-spacing: 3px;"></span>
                    </div>
                    <input type="text" class="form-control" id="captchaInput" placeholder="Shkruani kodin e mësipërm" style="padding-left: 15px;" required>
                    <div style="margin-top: 10px; font-size: 0.9rem; color: var(--text-medium);">
                        <i class="fas fa-sync-alt" id="refreshCaptcha" style="cursor: pointer; margin-right: 5px;"></i> 
                        Nuk lexohet? Klikoni për të rifreskuar kodin
                    </div>
                </div>

                <!-- Password strength meter -->
                <div class="password-strength-meter">
                    <div class="password-strength-value" id="passwordStrength"></div>
                </div>
                
                <button type="submit" class="login-btn">Kyçu <i class="fas fa-sign-in-alt ml-2"></i></button>
                
                <div class="form-footer">
                    <a href="forgot_password.html">Keni harruar fjalëkalimin?</a>
                    <a href="register_prinder.html">Regjistrohu si prind i ri</a>
                </div>
                
                <div class="privacy-notice">
                    <i class="fas fa-shield-alt privacy-icon"></i> Të dhënat tuaja mbrohen me enkriptim të avancuar dhe nuk ndahen me palë të treta.
                </div>
                
                <div class="security-badge">
                    <i class="fas fa-lock"></i> Lidhje e sigurt me enkriptim SSL
                </div>
                
                <div class="divider">
                    <span class="divider-text">OSE</span>
                </div>
                
                <div class="qr-login">
                    <div class="qr-title">Kyçu me kodin QR</div>
                    <div class="qr-code">
                        <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100">
                            <!-- Background -->
                            <rect width="100" height="100" fill="#ffffff" rx="10" ry="10"/>
                            
                            <!-- QR Code Matrix - customized for parents -->
                            <g fill="#8e24aa">
                                <!-- Pattern top-left -->
                                <rect x="10" y="10" width="30" height="30" rx="5" ry="5"/>
                                <rect x="15" y="15" width="20" height="20" fill="#ffffff" rx="3" ry="3"/>
                                <rect x="20" y="20" width="10" height="10" rx="2" ry="2"/>
                                
                                <!-- Pattern top-right -->
                                <rect x="60" y="10" width="30" height="30" rx="5" ry="5"/>
                                <rect x="65" y="15" width="20" height="20" fill="#ffffff" rx="3" ry="3"/>
                                <rect x="70" y="20" width="10" height="10" rx="2" ry="2"/>
                                
                                <!-- Pattern bottom-left -->
                                <rect x="10" y="60" width="30" height="30" rx="5" ry="5"/>
                                <rect x="15" y="65" width="20" height="20" fill="#ffffff" rx="3" ry="3"/>
                                <rect x="20" y="70" width="10" height="10" rx="2" ry="2"/>
                                
                                <!-- QR data elements -->
                                <rect x="45" y="10" width="5" height="5" rx="1" ry="1"/>
                                <rect x="50" y="15" width="5" height="5" rx="1" ry="1"/>
                                <rect x="45" y="25" width="5" height="5" rx="1" ry="1"/>
                                <rect x="45" y="45" width="5" height="5" rx="1" ry="1"/>
                                <rect x="25" y="45" width="5" height="5" rx="1" ry="1"/>
                                <rect x="55" y="45" width="5" height="5" rx="1" ry="1"/>
                                <rect x="60" y="50" width="5" height="5" rx="1" ry="1"/>
                                <rect x="65" y="55" width="5" height="5" rx="1" ry="1"/>
                                <rect x="45" y="55" width="5" height="5" rx="1" ry="1"/>
                                <rect x="30" y="50" width="5" height="5" rx="1" ry="1"/>
                                <rect x="35" y="55" width="5" height="5" rx="1" ry="1"/>
                                <rect x="65" y="65" width="5" height="5" rx="1" ry="1"/>
                                <rect x="70" y="60" width="5" height="5" rx="1" ry="1"/>
                                <rect x="75" y="75" width="5" height="5" rx="1" ry="1"/>
                                <rect x="85" y="65" width="5" height="5" rx="1" ry="1"/>
                                <rect x="85" y="85" width="5" height="5" rx="1" ry="1"/>
                                <rect x="75" y="85" width="5" height="5" rx="1" ry="1"/>
                            </g>
                            
                            <!-- Logo në qendër -->
                            <circle cx="50" cy="50" r="10" fill="#ffffff" stroke="#8e24aa" stroke-width="2"/>
                            <path d="M46 48 C46 44, 54 44, 54 48 C54 52, 46 52, 46 48 M46 52 L54 52" stroke="#8e24aa" stroke-width="1.5" fill="none"/>
                        </svg>
                    </div>
                    <div class="qr-help">Skanoni kodin QR me aplikacionin mobil të shkollës për kyçje të shpejtë dhe të sigurt</div>
                </div>
            </form>
            
            <!-- Loading Indicator -->
            <div class="loading-indicator" id="loadingIndicator">
                <div class="spinner"></div>
                <div class="loading-text">Duke u kyçur...</div>
            </div>
            
            <!-- Session Expire Warning -->
            <div class="session-expire-warning" id="sessionExpireWarning">
                <div><strong>Sesioni juaj do të skadojë së shpejti</strong></div>
                <div>Koha e mbetur: <span class="session-expire-timer" id="sessionTimer">2:00</span></div>
                <div class="session-buttons">
                    <button class="session-button extend-session" id="extendSession">Vazhdo sesionin</button>
                    <button class="session-button logout-session" id="logoutSession">Dilni</button>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="main-footer">
        <div class="container">
            <div class="footer-bottom">
                <p class="copyright">&copy; 2025 Shkolla Fillore "Kenan Halimi". Të gjitha të drejtat e rezervuara.</p>
            </div>
        </div>
    </footer>
    
    <!-- JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Variablat e sigurisë
            let loginAttempts = 0;
            const maxLoginAttempts = 5;
            let isLocked = false;
            let lockTime = 0;
            
            // Kontrollo nëse llogaria ka qenë e bllokuar më parë
            if (localStorage.getItem('accountLockedParent')) {
                const lockData = JSON.parse(localStorage.getItem('accountLockedParent'));
                const currentTime = new Date().getTime();
                
                if (currentTime < lockData.expiry) {
                    isLocked = true;
                    lockTime = Math.ceil((lockData.expiry - currentTime) / 60000); // konvertim në minuta
                    showAccountLockedMessage(lockTime);
                } else {
                    localStorage.removeItem('accountLockedParent');
                }
            }
            
            // Shtojmë CAPTCHA-n
            const captchaImage = document.querySelector('#captchaImage span');
            captchaImage.textContent = generateCaptcha();
            
            // Eventlisteners për CAPTCHA
            document.getElementById('refreshCaptcha').addEventListener('click', function() {
                captchaImage.textContent = generateCaptcha();
            });
            
            // Password toggle functionality
            const passwordToggle = document.getElementById('password-toggle');
            const passwordField = document.getElementById('password');
            
            passwordToggle.addEventListener('click', function() {
                const type = passwordField.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordField.setAttribute('type', type);
                
                // Toggle eye icon
                const iconClass = type === 'password' ? 'fa-eye' : 'fa-eye-slash';
                this.querySelector('i').className = 'fas ' + iconClass;
            });
            
            // Kontrollo forcën e fjalëkalimit
            passwordField.addEventListener('input', function() {
                checkPasswordStrength(this.value);
            });
            
            // Form validation with security checks
            const loginForm = document.getElementById('login-form');
            const loadingIndicator = document.getElementById('loadingIndicator');
            
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                if (isLocked) {
                    return; // Nëse llogaria është e bllokuar, nuk lejojmë kyçje
                }
                
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                if (!email || !password) {
                    showSecurityAlert('Ju lutemi plotësoni të gjitha fushat e detyrueshme.');
                    return;
                }
                
                // Kontrollo për sulme të mundshme
                if (checkForXSS(email) || checkForXSS(password) || 
                    checkForSQLInjection(email) || checkForSQLInjection(password)) {
                    
                    // Regjistrojmë tentativën e dyshimtë
                    console.log('Tentativë e dyshimtë: Sulm i mundshëm i sigurisë');
                    
                    showSecurityAlert('Është zbuluar një aktivitet i dyshimtë. Kjo përpjekje është regjistruar.');
                    
                    // Rrisim numrin e përpjekjeve
                    loginAttempts++;
                    showAttemptsWarning(loginAttempts);
                    
                    return;
                }
                
                // Kontrollo CAPTCHA nëse është e aktivizuar
                const captchaContainer = document.getElementById('captchaContainer');
                if (captchaContainer.style.display === 'block') {
                    const captchaInput = document.getElementById('captchaInput').value;
                    
                    if (captchaInput !== captchaImage.textContent) {
                        showSecurityAlert('CAPTCHA e pasaktë. Ju lutem shkruani kodin saktësisht siç tregohet.');
                        
                        // Rigjenerojmë CAPTCHA
                        captchaImage.textContent = generateCaptcha();
                        document.getElementById('captchaInput').value = '';
                        return;
                    }
                }
                
                // Show loading indicator
                loadingIndicator.style.display = 'flex';
                
                // Simulate authentication with security checks
                setTimeout(function() {
                    loadingIndicator.style.display = 'none';
                    
                    // Demo: Verifikojmë kredencialet
                    // Në një implementim të vërtetë, kjo do të bëhej në server
                    const demoCredentials = {
                        'parent@example.com': 'parent123',
                        'prindi': 'test123',
                        'admin': 'admin123'
                    };
                    
                    if (demoCredentials[email] === password) {
                        // Kyçja e suksesshme
                        
                        // Ruajmë kohën e kyçjes (për auditim)
                        localStorage.setItem('lastLoginParent', new Date().toISOString());
                        
                        // Rivendosim numëruesin e përpjekjeve
                        loginAttempts = 0;
                        localStorage.removeItem('accountLockedParent');
                        
                        // Startojmë kohëmatësin e sesionit
                        startSessionTimer();
                        
                        // Ridrejtojmë te dashboard
                        window.location.href = 'dashboard_prinder.html';
                    } else {
                        // Kyçja dështoi
                        loginAttempts++;
                        
                        // Tregojmë paralajmërimin e përpjekjeve
                        showAttemptsWarning(loginAttempts);
                        
                        // Kontrollojmë nëse llogaria duhet bllokuar
                        if (loginAttempts >= maxLoginAttempts) {
                            isLocked = true;
                            
                            // Vendosim kohën e bllokimit (15 minuta)
                            const lockExpiry = new Date().getTime() + (15 * 60 * 1000);
                            localStorage.setItem('accountLockedParent', JSON.stringify({
                                expiry: lockExpiry
                            }));
                            
                            // Tregojmë mesazhin e bllokimit
                            showAccountLockedMessage(15);
                        } else {
                            // Tregojmë mesazhin e gabimit
                            showSecurityAlert('Kyçja dështoi. Email/përdoruesi ose fjalëkalimi është i gabuar.');
                            
                            // Aktivizojmë CAPTCHA pas dy përpjekjeve të dështuara
                            if (loginAttempts >= 2) {
                                captchaContainer.style.display = 'block';
                            }
                        }
                    }
                }, 1500);
            });
            
            // Add animation class to container
            const loginContainer = document.querySelector('.login-container');
            loginContainer.classList.add('animated');
            
            // Add ripple effect to login button
            const loginBtn = document.querySelector('.login-btn');
            loginBtn.addEventListener('click', function(e) {
                const rect = this.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const ripple = document.createElement('span');
                ripple.style.position = 'absolute';
                ripple.style.width = '1px';
                ripple.style.height = '1px';
                ripple.style.borderRadius = '50%';
                ripple.style.background = 'rgba(255, 255, 255, 0.7)';
                ripple.style.transform = 'scale(0)';
                ripple.style.left = `${x}px`;
                ripple.style.top = `${y}px`;
                ripple.style.animation = 'ripple 0.6s linear';
                
                this.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 700);
            });
            
            // Add keyframe for ripple animation
            const style = document.createElement('style');
            style.innerHTML = `
                @keyframes ripple {
                    to {
                        transform: scale(70);
                        opacity: 0;
                    }
                }
            `;
            document.head.appendChild(style);
            
            // Funksionet e sigurisë
            
            // Kontrollo për tentativa sulmi XSS
            function checkForXSS(input) {
                const xssPattern = /<script|<\/script|javascript:|onerror=|onload=|eval\(|<iframe|<img|alert\(|document\.cookie|onclick=/i;
                return xssPattern.test(input);
            }
            
            // Kontrollo për tentativa sulmi SQL injection
            function checkForSQLInjection(input) {
                const sqlPattern = /(\%27)|(\')|(\-\-)|(ALTER TABLE)|(\;)|(DROP TABLE)|(UNION SELECT)|(SELECT \*)/i;
                return sqlPattern.test(input);
            }
            
            // Funksioni për gjenerimin e CAPTCHA
            function generateCaptcha() {
                const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                let captcha = '';
                for (let i = 0; i < 6; i++) {
                    captcha += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                return captcha;
            }
            
            // Funksioni për të shfaqur mesazhin e bllokimit të llogarisë
            function showAccountLockedMessage(minutes) {
                const securityAlert = document.getElementById('securityAlert');
                securityAlert.style.display = 'block';
                securityAlert.innerHTML = `
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Llogaria është përkohësisht e bllokuar</strong>
                    <p>Për shkak të shumë përpjekjeve të dështuara, ju lutemi provoni përsëri pas ${minutes} minutash.</p>
                `;
                
                // Bllokojmë fushat e formës
                document.getElementById('email').disabled = true;
                document.getElementById('password').disabled = true;
                document.querySelector('.login-btn').disabled = true;
            }
            
            // Funksioni për të treguar paralajmërimin e përpjekjeve
            function showAttemptsWarning(attempts) {
                const attemptsWarning = document.getElementById('attemptsWarning');
                const remaining = 5 - attempts;
                
                if (attempts > 0) {
                    attemptsWarning.style.display = 'block';
                    attemptsWarning.innerHTML = `
                        <i class="fas fa-exclamation-circle"></i>
                        Kujdes: Ju keni edhe ${remaining} përpjekje përpara se llogaria të bllokohet përkohësisht.
                    `;
                }
            }
            
            // Funksioni për të kontrolluar forcën e fjalëkalimit
            function checkPasswordStrength(password) {
                const passwordStrength = document.getElementById('passwordStrength');
                let strength = 0;
                
                // Kriteret për forcën e fjalëkalimit
                if (password.length >= 8) strength += 25;
                if (password.match(/[A-Z]/)) strength += 25;
                if (password.match(/[0-9]/)) strength += 25;
                if (password.match(/[^A-Za-z0-9]/)) strength += 25;
                
                // Përditësojmë shiritin e forcës së fjalëkalimit
                passwordStrength.style.width = `${strength}%`;
                
                // Ndryshojmë ngjyrën bazuar në forcën
                if (strength <= 25) {
                    passwordStrength.style.backgroundColor = '#f44336'; // E dobët (e kuqe)
                } else if (strength <= 50) {
                    passwordStrength.style.backgroundColor = '#ff9800'; // Mesatare (portokalli)
                } else if (strength <= 75) {
                    passwordStrength.style.backgroundColor = '#ffc107'; // E mirë (e verdhë)
                } else {
                    passwordStrength.style.backgroundColor = '#4caf50'; // E fortë (jeshile)
                }
            }
            
            // Funksioni për të shfaqur mesazhin e sigurisë
            function showSecurityAlert(message) {
                const securityAlert = document.getElementById('securityAlert');
                securityAlert.style.display = 'block';
                securityAlert.innerHTML = `
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Paralajmërim</strong>
                    <p>${message}</p>
                `;
            }
            
            // Funksioni për të startuar kohëmatësin e sesionit
            function startSessionTimer() {
                let timeLeft = 2 * 60; // 2 minuta në sekonda
                const timerDisplay = document.getElementById('sessionTimer');
                const sessionWarning = document.getElementById('sessionExpireWarning');
                
                // Pastrojmë çdo timer ekzistues
                if (window.sessionInterval) clearInterval(window.sessionInterval);
                
                // Nisim kohëmatësin e ri
                window.sessionInterval = setInterval(function() {
                    const minutes = Math.floor(timeLeft / 60);
                    let seconds = timeLeft % 60;
                    seconds = seconds < 10 ? '0' + seconds : seconds;
                    
                    timerDisplay.textContent = `${minutes}:${seconds}`;
                    
                    if (timeLeft <= 0) {
                        clearInterval(window.sessionInterval);
                        window.location.href = 'index.html'; // Kthim në faqen kryesore pas skadimit
                    } else if (timeLeft === 30) {
                        // Tregojmë paralajmërimin kur mbesin 30 sekonda
                        sessionWarning.style.display = 'block';
                    }
                    
                    timeLeft--;
                }, 1000);
            }
            
            // Butonët e sesionit
            document.getElementById('extendSession').addEventListener('click', function() {
                document.getElementById('sessionExpireWarning').style.display = 'none';
                startSessionTimer(); // Rifillohet numërimi
            });
            
            document.getElementById('logoutSession').addEventListener('click', function() {
                window.location.href = 'index.html'; // Kthim në faqen kryesore
            });
        });
    </script>
</body>
</html>